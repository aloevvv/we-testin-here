<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>FNAF Fan Game</title>
  <style>
    body {
      margin: 0;
      background-color: black;
      font-family: 'Courier New', monospace;
      color: white;
      text-align: center;
    }

    #menu {
      margin-top: 20%;
    }

    .menu-option {
      font-size: 24px;
      margin: 15px;
      cursor: pointer;
    }

    .disabled {
      color: gray;
      cursor: not-allowed;
    }

    #game {
      display: none;
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
    }

    #office, #camView {
      width: 100%;
      height: 100%;
      object-fit: cover;
      position: absolute;
      top: 0;
      left: 0;
    }

    #cameraBtn {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 150px;
      cursor: pointer;
      z-index: 12;
      top: unset; 
    }
    #camLabel {
  position: absolute;
  top: 10px;
  left: 10px;
  font-size: 28px;
  font-family: 'Courier New', monospace;
  color: white;
  background-color: rgba(0,0,0,0.5);
  padding: 5px 10px;
  border-radius: 4px;
  z-index: 15;
}


    #map {
      position: absolute;
      bottom: 20px;
      right: 20px;
      width: 320px;
      height: 240px;
      display: none;
      z-index: 6;
    }

    #staticOverlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0.3;
      display: none;
      z-index: 10;
      pointer-events: none;
    }
    .door {
  position: absolute;
  top: 0;
  height: 100%;
  width: 100%;
  z-index: 8;
}

.door-left {
  left: 0;
}

.door-right {
  right: 0;
}

#darkOverlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: black;
  opacity: 0; /* starts transparent */
  pointer-events: none;
  z-index: 20; /* above everything */
  transition: opacity 0.5s;
}

  </style>
</head>
<body>
  <!-- Menu -->
  <div id="menu">
    <h1>Five Nights At Starr Park</h1>
    <div id="newGameBtn" class="menu-option">New Game</div>
    <div id="continueBtn" class="menu-option disabled">Continue</div>
  </div>

  <!-- Game Scene -->
  <div id="game">
    <img id="office" src="office.png" alt="Office">
    <img id="camView" src="CAM1PMS.png" style="display:none;">
    <img id="cameraBtn" src="camera.png">
    <img id="map" src="map.png">
    <div id="camLabel">CAM1</div>
    <img id="staticOverlay" src="static.gif">
    <img id="doorA" src="doorAoff.png" class="door door-left">
    <img id="doorB" src="doorBoff.png" class="door door-right">
    <div id="darkOverlay"></div>
    <div id="hourLabel" style="
  position:absolute; top:10px; right:10px;
  font-size:28px; color:white; font-family:'Courier New', monospace;
  z-index:15;">12AM</div>
  </div>
  


  <!-- Ambience Audio -->
  <audio id="ambience" src="ambience.mp3" loop></audio>
  <audio id="footsteps" src="footsteps.mp3"></audio>

  <script>
// ====== GAME STATE ======
// ====== GAME STATE ======
let CamOn = false;
let currentCam = "CAM1";
let paranoiaTimer = null;
let paranoid = false;

let Night1Won = localStorage.getItem("Night1Won") === "false";
let Night2Won = localStorage.getItem("Night2Won") === "false";
let Night3Won = localStorage.getItem("Night3Won") === "false";
let Night4Won = localStorage.getItem("Night4Won") === "false";
let Night5Won = localStorage.getItem("Night5Won") === "false";

let currentNight = parseInt(localStorage.getItem("currentNight")) || 1;
let currentHour = 12;
let nightTimer = null;



// Enemy positions
let Punch = "CAM1";
let Snipe = "CAM1";
let Mouse = "CAM1";

let BossStage = 1;       
let BossProgress = 0; 
let bossTimer = null;
let rocketActive = false;
let rocketCam = null;
let rocketTimer = null;

// AI levels (0–20)
let PunchAI = 0;
let SnipeAI = 0;
let MouseAI = 5;
let BossAI = 5;

const nightAI = {
  1: {
    12: { Punch: 0, Snipe: 0, Mouse: 5 },
    1:  { Punch: 6, Snipe: 5, Mouse: 4 },
    2:  { Punch: 7, Snipe: 6, Mouse: 4 },
    3:  { Punch: 8, Snipe: 7, Mouse: 5 },
    4:  { Punch: 9, Snipe: 8, Mouse: 5 },
    5:  { Punch: 10, Snipe: 9, Mouse: 6 }
  },
  2: {
    12: { Punch: 8, Snipe: 7, Mouse: 5 },
    1:  { Punch: 9, Snipe: 8, Mouse: 6 },
    2:  { Punch: 10, Snipe: 9, Mouse: 6 },
    3:  { Punch: 12, Snipe: 10, Mouse: 7 },
    4:  { Punch: 13, Snipe: 11, Mouse: 8 },
    5:  { Punch: 14, Snipe: 12, Mouse: 9 }
  },
  2: {
    12: { Punch: 8, Snipe: 7, Mouse: 5 },
    1:  { Punch: 9, Snipe: 8, Mouse: 6 },
    2:  { Punch: 10, Snipe: 9, Mouse: 6 },
    3:  { Punch: 12, Snipe: 10, Mouse: 7 },
    4:  { Punch: 13, Snipe: 11, Mouse: 8 },
    5:  { Punch: 14, Snipe: 12, Mouse: 9 }
  },
  3: {
    12: { Punch: 8, Snipe: 7, Mouse: 5 },
    1:  { Punch: 9, Snipe: 8, Mouse: 6 },
    2:  { Punch: 10, Snipe: 9, Mouse: 6 },
    3:  { Punch: 12, Snipe: 10, Mouse: 7 },
    4:  { Punch: 13, Snipe: 11, Mouse: 8 },
    5:  { Punch: 14, Snipe: 12, Mouse: 9 }
  },
  4: {
    12: { Punch: 8, Snipe: 7, Mouse: 5 },
    1:  { Punch: 9, Snipe: 8, Mouse: 6 },
    2:  { Punch: 10, Snipe: 9, Mouse: 6 },
    3:  { Punch: 12, Snipe: 10, Mouse: 7 },
    4:  { Punch: 13, Snipe: 11, Mouse: 8 },
    5:  { Punch: 14, Snipe: 12, Mouse: 9 }
  },
  5: {
    12: { Punch: 8, Snipe: 7, Mouse: 5 },
    1:  { Punch: 9, Snipe: 8, Mouse: 6 },
    2:  { Punch: 10, Snipe: 9, Mouse: 6 },
    3:  { Punch: 12, Snipe: 10, Mouse: 7 },
    4:  { Punch: 13, Snipe: 11, Mouse: 8 },
    5:  { Punch: 14, Snipe: 12, Mouse: 9 }
  }
};

    
let doorAParanoiaTimer = null;
let doorBParanoiaTimer = null;

// Track cumulative closed time
let doorATotalClosed = 0;
let doorBTotalClosed = 0;

// Track when door was last closed
let doorAClosedAt = null;
let doorBClosedAt = null;

let doorADisabled = false;
let doorBDisabled = false;


// Valid paths
const PunchPath = ["CAM1","CAM5","CAM4","CAM9A"];
const SnipePath = ["CAM1","CAM2","CAM3","CAM8","CAM6","CAM9B"];
const MousePath = ["CAM1","CAM1B","CAM2","CAM3","CAM8","CAM6","CAM9B"];

// Door states
let doorAClosed = false;
let doorBClosed = false;

// Infection meter
let infected = 0; // 0–60
let infectionInterval = null;

// Kill timers
let punchDoorTimer = null;
let snipeDoorTimer = null;
let mouseDoorTimer = null;

// ====== GAME START ======
function startNewGame() {
  document.getElementById("menu").style.display = "none";
  document.getElementById("game").style.display = "block";
  const ambience = document.getElementById("ambience");
  ambience.volume = 0.1;
  ambience.play();
  startAI();
  startInfectionMeter();
  startNight();
}
    function advanceHour() {
  if (currentHour === 12) {
    currentHour = 1;
  } else {
    currentHour++;
  }

  setAIForHour(currentNight, currentHour);

  updateHourLabel();

  if (currentHour === 6) {
    endNight();
  }
}

function setAIForHour(night, hour) {
  if (nightAI[night] && nightAI[night][hour]) {
    PunchAI = nightAI[night][hour].Punch;
    SnipeAI = nightAI[night][hour].Snipe;
    MouseAI = nightAI[night][hour].Mouse;
    console.log(`Night ${night}, ${hour}AM: Punch=${PunchAI}, Snipe=${SnipeAI}, Mouse=${MouseAI}`);
  }
}


    function startNight() {
  currentHour = 12;
  updateHourLabel();
  
  nightTimer = setInterval(() => {
    advanceHour();
  }, 60000); 
}
    function endNight() {
  clearInterval(nightTimer);
  nightTimer = null;
  resetAllGameStates();

  if (currentNight === 1) {
    Night1Won = true;
    localStorage.setItem("Night1Won", "true");
    currentNight = 2;
  } else if (currentNight === 2) {
    Night2Won = true;
    localStorage.setItem("Night2Won", "true");
    currentNight = 3;
  } else if (currentNight === 3) {
    Night3Won = true;
    localStorage.setItem("Night3Won", "true");
    currentNight = 4;
  } else if (currentNight === 4) {
    Night4Won = true;
    localStorage.setItem("Night4Won", "true");
    currentNight = 5;
  } else if (currentNight === 5) {
    Night5Won = true;
    localStorage.setItem("Night5Won", "true");
    showMenu();
    return;
  }

  localStorage.setItem("currentNight", currentNight);

  startNight();
}


function updateHourLabel() {
  let label;
  if (currentHour === 12) {
    label = "12AM";
  } else {
    label = currentHour + "AM";
  }
  document.getElementById("hourLabel").textContent = label;
}




// ====== CAMERA TOGGLE ======
function toggleCamera() {
  CamOn = !CamOn;
  if (CamOn) {
    document.getElementById("office").style.display = "none";
    document.getElementById("camView").style.display = "block";
    document.getElementById("map").style.display = "block";
    document.getElementById("staticOverlay").style.display = "block";
    document.getElementById("doorA").style.display = "none";
    document.getElementById("doorB").style.display = "none";
    resetParanoia();
    updateCameraView();
  } else {
    document.getElementById("office").style.display = "block";
    document.getElementById("camView").style.display = "none";
    document.getElementById("map").style.display = "none";
    document.getElementById("staticOverlay").style.display = "none";
    document.getElementById("doorA").style.display = "block";
    document.getElementById("doorB").style.display = "block";
    clearTimeout(paranoiaTimer);
  }
}

window.addEventListener("DOMContentLoaded", () => {
  // Attach camera button click
  document.getElementById("cameraBtn").addEventListener("click", toggleCamera);

  // Attach New Game button click
  document.getElementById("newGameBtn").addEventListener("click", startNewGame);

document.addEventListener("keydown", e => {
  // Spacebar toggles cams
  if (e.code === "Space") {
    toggleCamera();
    return; 
  }

  if (!CamOn) return;
  switch(e.key) {
    case "1": currentCam="CAM1"; break;
    case "2": currentCam="CAM2"; break;
    case "3": currentCam="CAM3"; break;
    case "4": currentCam="CAM4"; break;
    case "5": currentCam="CAM5"; break;
    case "6": currentCam="CAM6"; break;
    case "7": currentCam="CAM7"; break;
    case "8": currentCam="CAM8"; break;
    case "9": currentCam="CAM9A"; break;
    case "0": currentCam="CAM9B"; break;
  }
  updateCameraView();
  resetParanoia();
});

  function resetParanoia() {
  if (paranoiaTimer) {
    clearTimeout(paranoiaTimer);
    paranoiaTimer = null;
  }

  paranoiaTimer = setTimeout(() => {
    paranoid = true;
    console.log("Paranoia triggered!");
  }, 15000); // 15 seconds, adjust as needed
}



  document.addEventListener("keydown", e => {
  if (e.key === "a" || e.key === "A") {
    if (doorADisabled) return; // ignore if disabled

    doorAClosed = !doorAClosed;
    document.getElementById("doorA").src = doorAClosed ? "doorAon.png" : "doorAoff.png";

    let audioA = new Audio("door.mp3");
    audioA.play();

    if (doorAClosed) {
      resetDoor("A");
      startParanoiaTimer("A");
      doorAClosedAt = Date.now();
    } else {
      clearParanoiaTimer("A");
      if (doorAClosedAt) {
        doorATotalClosed += (Date.now() - doorAClosedAt) / 1000;
        doorAClosedAt = null;
      }
      checkDisable("A");
    }
  }
    
if (e.key === "e" || e.key === "E") {
  if (BossStage === "Maddened") {
    BossStage = 4;
    console.log("Boss calmed back to Stage 4");
  } else if (BossStage === 4) {
    BossStage = 5;
    spawnRocket();
    console.log("Boss forced to Stage 5!");
  }
}



  if (e.key === "d" || e.key === "D") {
    if (doorBDisabled) return;

    doorBClosed = !doorBClosed;
    document.getElementById("doorB").src = doorBClosed ? "doorBon.png" : "doorBoff.png";

    let audioB = new Audio("door.mp3");
    audioB.play();

    if (doorBClosed) {
      resetDoor("B");
      startParanoiaTimer("B");
      doorBClosedAt = Date.now();
    } else {
      clearParanoiaTimer("B");
      if (doorBClosedAt) {
        doorBTotalClosed += (Date.now() - doorBClosedAt) / 1000;
        doorBClosedAt = null;
      }
      checkDisable("B");
      }
    }
  });
});


// ====== CAMERA IMAGE LOGIC ======
function getActualImage(cam) {
  let enemiesHere = [];
  if (Punch === cam) enemiesHere.push("P");
  if (Snipe === cam) enemiesHere.push("S");
  if (Mouse === cam) enemiesHere.push("M");

  if (cam === "CAM7") {
    return getBossImage();
  }

  return enemiesHere.length > 0 ? cam + enemiesHere.join("") + ".png" : cam + ".png";
}
    function getBossImage() {
  if (BossStage === 1) return "CAM7stage1.png";
  if (BossStage === 2) return "CAM7stage2.png";
  if (BossStage === 3) return "CAM7stage3.png";
  if (BossStage === 4) return "CAM7stage4.png";
  if (BossStage === "Maddened") return "CAM7stageangry.png";
  if (BossStage === 5) return "CAM7stage5.png";
  return "CAM7stage1.png"; // fallback
}


function getHallucinationImages(cam) {
  let options = [cam + ".png"];
  if (MousePath.includes(cam)) options.push(cam + "M.png");
  if (SnipePath.includes(cam)) options.push(cam + "S.png");
  if (PunchPath.includes(cam)) options.push(cam + "P.png");
  if (MousePath.includes(cam) && SnipePath.includes(cam)) options.push(cam + "MS.png");
  if (PunchPath.includes(cam) && SnipePath.includes(cam)) options.push(cam + "PS.png");
  if (PunchPath.includes(cam) && MousePath.includes(cam)) options.push(cam + "PM.png");
  if (PunchPath.includes(cam) && MousePath.includes(cam) && SnipePath.includes(cam)) options.push(cam + "PMS.png");
  return options;
}

function updateCameraView() {
  const camView = document.getElementById("camView");
  if (paranoid && Math.random() < 0.5) {
    let hallucinations = getHallucinationImages(currentCam);
    camView.src = hallucinations[Math.floor(Math.random() * hallucinations.length)];
  } else {
    camView.src = getActualImage(currentCam);
  }

  // Update CAM label
  document.getElementById("camLabel").textContent = currentCam;
}


// ====== AI LOOP ======
function startAI() {
  setInterval(movePunch, 5000);
  setInterval(moveSnipe, 5000);
  setInterval(moveMouse, 2500);
}

function playFootsteps() {
  document.getElementById("footsteps").play();
}

// Punch AI
function movePunch() {
  let roll = Math.floor(Math.random() * 20) + 1;
  if (roll <= PunchAI) {
    if (Punch==="CAM1") { Punch="CAM5"; }
    else if (Punch==="CAM5") { Punch=Math.random()<0.5?"CAM4":"CAM9A"; }
    else if (Punch==="CAM4") { Punch="CAM5"; }
    else if (Punch==="CAM9A") { Punch=Math.random()<0.75?"doorA":"CAM5"; }
    playFootsteps();
    updateCameraView();
    checkDoorStates();
    updateDoorSprites();
  }
}

// Snipe AI
function moveSnipe() {
  let roll = Math.floor(Math.random() * 20) + 1;
  if (roll <= SnipeAI) {
    if (Snipe==="CAM1") Snipe="CAM2";
    else if (Snipe==="CAM2") Snipe="CAM3";
    else if (Snipe==="CAM3") Snipe=Math.random()<0.75?"CAM8":"CAM2";
    else if (Snipe==="CAM8") Snipe="CAM6";
    else if (Snipe==="CAM6") Snipe=Math.random()<0.75?"CAM9B":"CAM8";
    else if (Snipe==="CAM9B") Snipe="doorB";
    playFootsteps();
    updateCameraView();
    checkDoorStates();
    updateDoorSprites();
  }
}

// Mouse AI
function moveMouse() {
  let roll = Math.floor(Math.random() * 20) + 1;
  if (roll <= MouseAI) {
    if (Mouse==="CAM1") Mouse=Math.random()<0.8?"CAM1B":"CAM2";
    else if (Mouse==="CAM1B") Mouse=Math.random()<0.9?"CAM1B":"CAM1";
    else if (Mouse==="CAM2") Mouse="CAM3";
    else if (Mouse==="CAM3") Mouse="CAM8";
    else if (Mouse==="CAM8") Mouse="CAM6";
    else if (Mouse==="CAM6") Mouse="CAM9B";
    else if (Mouse==="CAM9B") Mouse="doorB";
    updateCameraView();
    checkDoorStates();
    updateDoorSprites();

  }
}
    function updateBoss() {
  if (BossStage <= 3) {
    if (CamOn && currentCam === "CAM7") {
      console.log("Boss progress blocked by CAM7 view");
    } else {
      BossProgress += BossAI;
      if ((BossStage === 1 && BossProgress >= 60) ||
          (BossStage === 2 && BossProgress >= 60) ||
          (BossStage === 3 && BossProgress >= 100)) {
        BossStage++;
        BossProgress = 0;
      }
    }
  } else if (BossStage === 4) {
    let roll = Math.floor(Math.random() * 20) + 1;
    if (roll <= BossAI) {
      BossStage = "Maddened";
      console.log("Boss entered Maddened Stage!");
    }
  } else if (BossStage === "Maddened") {

    setTimeout(() => { BossStage = 5; spawnRocket(); }, 5000);
  }
  updateBossCam();
}
bossTimer = setInterval(updateBoss, 5000);

function updateBossCam() {
  const camView = document.getElementById("camView");
  if (currentCam === "CAM7") {
    if (BossStage === 1) camView.src = "CAM7stage1.png";
    else if (BossStage === 2) camView.src = "CAM7stage2.png";
    else if (BossStage === 3) camView.src = "CAM7stage3.png";
    else if (BossStage === 4) camView.src = "CAM7stage4.png";
    else if (BossStage === "Maddened") camView.src = "CAM7stageangry.png";
    else if (BossStage === 5) camView.src = "CAM7stage5.png";
  }
}
function spawnRocket() {
  let cams = ["CAM2","CAM3","CAM4","CAM5","CAM6","CAM8"];
  rocketCam = cams[Math.floor(Math.random() * cams.length)];
  rocketActive = true;
  console.log("Rocket spawned in", rocketCam);

  // infection increase
  infectionInterval = setInterval(() => {
    infected = Math.min(60, infected+1);
    darkenScreen();
  }, 1000);

  // fail-safe timer
  rocketTimer = setTimeout(() => {
    if (rocketActive) killPlayer("Boss");
  }, 8000);
}

function clickRocket(cam) {
  if (rocketActive && cam === rocketCam) {
    rocketActive = false;
    clearInterval(infectionInterval);
    clearTimeout(rocketTimer);
    BossStage = 2;
    BossProgress = 0;
    console.log("Rocket defused, Boss reset to Stage 2");
  }
}

camView.addEventListener("click", () => {
  clickRocket(currentCam);
});


function updateDoorSprites() {
  // Door A (Punch)
  if (Punch === "doorA" && !doorAClosed) {
    document.getElementById("doorA").src = "doorApunch.png";
  } else {
    document.getElementById("doorA").src = doorAClosed ? "doorAon.png" : "doorAoff.png";
  }

  // Door B (Snipe)
  if (Snipe === "doorB" && !doorBClosed) {
    document.getElementById("doorB").src = "doorBsnipe.png";
  } else {
    document.getElementById("doorB").src = doorBClosed ? "doorBon.png" : "doorBoff.png";
  }
}

function startInfectionMeter() {
  infectionInterval = setInterval(() => {
    if ((Punch==="doorA" && !doorAClosed) || (Snipe==="doorB" && !doorBClosed) || (Mouse==="doorB" && !doorBClosed)) {
      infected = Math.min(60, infected+1);
      darkenScreen();
    }
  }, 2000);
}

function darkenScreen() {
  let overlay = document.getElementById("darkOverlay");
  overlay.style.opacity = infected/60; // 0 to 1
}

function checkDoorStates() {
  if (Punch==="doorA" && !doorAClosed) {
    if (!punchDoorTimer) punchDoorTimer = setTimeout(()=>killPlayer("Punch"),10000);
  }
  if (Snipe==="doorB" && !doorBClosed) {
    if (!snipeDoorTimer) snipeDoorTimer = setTimeout(()=>killPlayer("Snipe"),10000);
  }
  if (Mouse==="doorB" && !doorBClosed) {
    if (!mouseDoorTimer) mouseDoorTimer = setTimeout(()=>killPlayer("Mouse"),10000);
  }
}

function resetDoor(which) {
  if (which==="A") {
    if (Punch==="doorA") {
      Punch="CAM1";
      clearTimeout(punchDoorTimer);
      punchDoorTimer = null;
      let bangA = new Audio("metalbang.mp3");
      bangA.play();
    }
  }
  if (which==="B") {
    if (Snipe==="doorB") {
      Snipe="CAM1";
      clearTimeout(snipeDoorTimer);
      snipeDoorTimer = null;
      let bangB = new Audio("metalbang.mp3");
      bangB.play();
    }
    if (Mouse==="doorB") {
      Mouse="CAM1";
      clearTimeout(mouseDoorTimer);
      mouseDoorTimer = null;
      let bangC = new Audio("scratching.mp3");
      bangC.play();
    }
  }
  updateCameraView();
  updateDoorSprites();
}

    function startParanoiaTimer(which) {
  if (which === "A") {
    clearParanoiaTimer("A");
    doorAParanoiaTimer = setTimeout(() => {
      paranoid = true;
      console.log("Paranoia triggered by Door A");
    }, 7000);
  }
  if (which === "B") {
    clearParanoiaTimer("B");
    doorBParanoiaTimer = setTimeout(() => {
      paranoid = true;
      console.log("Paranoia triggered by Door B");
    }, 7000);
  }
}

function clearParanoiaTimer(which) {
  if (which === "A" && doorAParanoiaTimer) {
    clearTimeout(doorAParanoiaTimer);
    doorAParanoiaTimer = null;
  }
  if (which === "B" && doorBParanoiaTimer) {
    clearTimeout(doorBParanoiaTimer);
    doorBParanoiaTimer = null;
  }
}
    
setInterval(() => {
  if (doorAClosed && doorAClosedAt && !doorADisabled) {
    let elapsed = (Date.now() - doorAClosedAt) / 1000;
    if (doorATotalClosed + elapsed >= 120) { // or 5 for testing
      disableDoor("A");
    }
  }
  if (doorBClosed && doorBClosedAt && !doorBDisabled) {
    let elapsed = (Date.now() - doorBClosedAt) / 1000;
    if (doorBTotalClosed + elapsed >= 120) {
      disableDoor("B");
    }
  }
}, 1000);
    
function disableDoor(which) {
  if (which === "A") {
    doorAClosed = false;
    doorADisabled = true;
    doorAClosedAt = null;
    document.getElementById("doorA").src = "doorAoff.png";
    console.log("Door A permanently disabled");
  }
  if (which === "B") {
    doorBClosed = false;
    doorBDisabled = true;
    doorBClosedAt = null;
    document.getElementById("doorB").src = "doorBoff.png";
    console.log("Door B permanently disabled");
  }
}

function showMenu() {
  document.getElementById("game").style.display = "none";
  document.getElementById("menu").style.display = "block";

  const continueBtn = document.getElementById("continueBtn");

  // Check if player has beaten at least one night
  if (Night1Won || Night2Won || Night3Won || Night4Won || Night5Won) {
    continueBtn.classList.remove("disabled");
    continueBtn.textContent = "Continue (Night " + currentNight + ")";
  } else {
    continueBtn.classList.add("disabled");
    continueBtn.textContent = "Continue";
  }
}

document.getElementById("continueBtn").addEventListener("click", () => {
  if (!document.getElementById("continueBtn").classList.contains("disabled")) {
    document.getElementById("menu").style.display = "none";
    document.getElementById("game").style.display = "block";
    startNight();
  }
});

function killPlayer(enemy) {
  const camView = document.getElementById("camView");
  camView.style.display = "block";
  camView.src = enemy.toLowerCase() + "jumpscare.png";

  let audio = new Audio("jumpscare.mp3");
  audio.play();

  setTimeout(() => {
    showMenu();
  }, 3000);
}

    function resetAllGameStates() {
  // --- Clear enemy timers ---
  if (punchDoorTimer) {
    clearTimeout(punchDoorTimer);
    punchDoorTimer = null;
  }
  if (snipeDoorTimer) {
    clearTimeout(snipeDoorTimer);
    snipeDoorTimer = null;
  }
  if (mouseDoorTimer) {
    clearTimeout(mouseDoorTimer);
    mouseDoorTimer = null;
  }

  // --- Reset enemy positions ---
  Punch = "CAM1";
  Snipe = "CAM1";
  Mouse = "CAM1";

  // --- Reset paranoia ---
  if (paranoiaTimer) {
    clearTimeout(paranoiaTimer);
    paranoiaTimer = null;
  }
  paranoid = false;

  // --- Reset doors ---
  doorAClosed = false;
  doorBClosed = false;
  doorADisabled = false;
  doorBDisabled = false;
  doorATotalClosed = 0;
  doorBTotalClosed = 0;
  doorAClosedAt = null;
  doorBClosedAt = null;
  document.getElementById("doorA").src = "doorAoff.png";
  document.getElementById("doorB").src = "doorBoff.png";

  // --- Reset overlays ---
  document.getElementById("staticOverlay").style.display = "none";
  document.getElementById("darkOverlay").style.opacity = 0;

  // --- Reset HUD ---
  document.getElementById("camLabel").textContent = "CAM1";
  document.getElementById("hourLabel").textContent = "12AM";

  console.log("Game states reset for next night");
}

  

  </script>
</body>
</html>
