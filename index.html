<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>FNAF Fan Game</title>
  <style>
    body {
      margin: 0;
      background-color: black;
      font-family: 'Courier New', monospace;
      color: white;
      text-align: center;
    }

    #menu {
      margin-top: 20%;
    }

    .menu-option {
      font-size: 24px;
      margin: 15px;
      cursor: pointer;
    }

    .disabled {
      color: gray;
      cursor: not-allowed;
    }

    #game {
      display: none;
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
    }

    #office, #camView {
      width: 100%;
      height: 100%;
      object-fit: cover;
      position: absolute;
      top: 0;
      left: 0;
    }

    #cameraBtn {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 150px;
      cursor: pointer;
      z-index: 5; /* stays above office/cam but below static */
    }

    #map {
      position: absolute;
      bottom: 20px;
      right: 20px;
      width: 320px;
      height: 240px;
      display: none;
      z-index: 6;
    }

    #staticOverlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0.3;
      display: none;
      z-index: 10;
      pointer-events: none;
    }
    .door {
  position: absolute;
  top: 0;
  height: 100%;
  width: 100%;
  z-index: 8;
}

.door-left {
  left: 0;
}

.door-right {
  right: 0;
}

#darkOverlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: black;
  opacity: 0; /* starts transparent */
  pointer-events: none;
  z-index: 20; /* above everything */
  transition: opacity 0.5s;
}

  </style>
</head>
<body>
  <!-- Menu -->
  <div id="menu">
    <h1>Five Nights At Starr Park</h1>
    <div id="newGameBtn" class="menu-option">New Game</div>
    <div id="continueBtn" class="menu-option disabled">Continue</div>
  </div>

  <!-- Game Scene -->
  <div id="game">
    <img id="office" src="office.png" alt="Office">
    <img id="camView" src="CAM1.png" style="display:none;">
    <img id="cameraBtn" src="camera.png">
    <img id="map" src="map.png">
    <img id="staticOverlay" src="static.gif">
    <img id="doorA" src="doorAoff.png" class="door door-left">
    <img id="doorB" src="doorBoff.png" class="door door-right">
    <div id="darkOverlay"></div>
  </div>
  


  <!-- Ambience Audio -->
  <audio id="ambience" src="ambience.mp3" loop></audio>
  <audio id="footsteps" src="footsteps.mp3"></audio>

  <script>
// ====== GAME STATE ======
// ====== GAME STATE ======
let CamOn = false;
let currentCam = "CAM1";
let paranoiaTimer = null;
let paranoid = false;

// Enemy positions
let Punch = "CAM1";
let Snipe = "CAM1";
let Mouse = "CAM1";

// AI levels (0–20)
let PunchAI = 5;
let SnipeAI = 5;
let MouseAI = 5;

// Valid paths
const PunchPath = ["CAM1","CAM5","CAM4","CAM9A"];
const SnipePath = ["CAM1","CAM2","CAM3","CAM8","CAM6","CAM9B"];
const MousePath = ["CAM1","CAM1B","CAM2","CAM3","CAM8","CAM6","CAM9B"];

// Door states
let doorAClosed = false;
let doorBClosed = false;

// Infection meter
let infected = 0; // 0–60
let infectionInterval = null;

// Kill timers
let punchDoorTimer = null;
let snipeDoorTimer = null;
let mouseDoorTimer = null;

// ====== GAME START ======
function startNewGame() {
  document.getElementById("menu").style.display = "none";
  document.getElementById("game").style.display = "block";
  const ambience = document.getElementById("ambience");
  ambience.volume = 0.1;
  ambience.play();
  startAI();
  startInfectionMeter();
}

// ====== CAMERA TOGGLE ======
function toggleCamera() {
  CamOn = !CamOn;
  if (CamOn) {
    document.getElementById("office").style.display = "none";
    document.getElementById("camView").style.display = "block";
    document.getElementById("map").style.display = "block";
    document.getElementById("staticOverlay").style.display = "block";
    document.getElementById("doorA").style.display = "none";
    document.getElementById("doorB").style.display = "none";
    resetParanoia();
    updateCameraView();
  } else {
    document.getElementById("office").style.display = "block";
    document.getElementById("camView").style.display = "none";
    document.getElementById("map").style.display = "none";
    document.getElementById("staticOverlay").style.display = "none";
    document.getElementById("doorA").style.display = "block";
    document.getElementById("doorB").style.display = "block";
    clearTimeout(paranoiaTimer);
  }
}

// ====== CAMERA KEYBINDS ======
document.addEventListener("keydown", e => {
  if (!CamOn) return;
  switch(e.key) {
    case "1": currentCam="CAM1"; break;
    case "2": currentCam="CAM2"; break;
    case "3": currentCam="CAM3"; break;
    case "4": currentCam="CAM4"; break;
    case "5": currentCam="CAM5"; break;
    case "6": currentCam="CAM6"; break;
    case "7": currentCam="CAM7"; break;
    case "8": currentCam="CAM8"; break;
    case "9": currentCam="CAM9A"; break;
    case "0": currentCam="CAM9B"; break;
  }
  updateCameraView();
  resetParanoia();
});

// ====== CAMERA IMAGE LOGIC ======
function getActualImage(cam) {
  let enemiesHere = [];
  if (Punch === cam) enemiesHere.push("P");
  if (Snipe === cam) enemiesHere.push("S");
  if (Mouse === cam) enemiesHere.push("M");
  return enemiesHere.length > 0 ? cam + enemiesHere.join("") + ".png" : cam + ".png";
}

function getHallucinationImages(cam) {
  let options = [cam + ".png"];
  if (MousePath.includes(cam)) options.push(cam + "M.png");
  if (SnipePath.includes(cam)) options.push(cam + "S.png");
  if (PunchPath.includes(cam)) options.push(cam + "P.png");
  if (MousePath.includes(cam) && SnipePath.includes(cam)) options.push(cam + "MS.png");
  if (PunchPath.includes(cam) && SnipePath.includes(cam)) options.push(cam + "PS.png");
  if (PunchPath.includes(cam) && MousePath.includes(cam)) options.push(cam + "PM.png");
  if (PunchPath.includes(cam) && MousePath.includes(cam) && SnipePath.includes(cam)) options.push(cam + "PMS.png");
  return options;
}

function updateCameraView() {
  const camView = document.getElementById("camView");
  if (paranoid && Math.random() < 0.5) {
    let hallucinations = getHallucinationImages(currentCam);
    camView.src = hallucinations[Math.floor(Math.random() * hallucinations.length)];
  } else {
    camView.src = getActualImage(currentCam);
  }
}

// ====== AI LOOP ======
function startAI() {
  setInterval(movePunch, 5000);
  setInterval(moveSnipe, 5000);
  setInterval(moveMouse, 2500);
}

function playFootsteps() {
  document.getElementById("footsteps").play();
}

// Punch AI
function movePunch() {
  let roll = Math.floor(Math.random() * 20) + 1;
  if (roll <= PunchAI) {
    if (Punch==="CAM1") { Punch="CAM5"; }
    else if (Punch==="CAM5") { Punch=Math.random()<0.5?"CAM4":"CAM9A"; }
    else if (Punch==="CAM4") { Punch="CAM5"; }
    else if (Punch==="CAM9A") { Punch=Math.random()<0.75?"doorA":"CAM5"; }
    playFootsteps();
    updateCameraView();
    checkDoorStates();
  }
}

// Snipe AI
function moveSnipe() {
  let roll = Math.floor(Math.random() * 20) + 1;
  if (roll <= SnipeAI) {
    if (Snipe==="CAM1") Snipe="CAM2";
    else if (Snipe==="CAM2") Snipe="CAM3";
    else if (Snipe==="CAM3") Snipe=Math.random()<0.75?"CAM8":"CAM2";
    else if (Snipe==="CAM8") Snipe="CAM6";
    else if (Snipe==="CAM6") Snipe=Math.random()<0.75?"CAM9B":"CAM8";
    else if (Snipe==="CAM9B") Snipe="doorB";
    playFootsteps();
    updateCameraView();
    checkDoorStates();
  }
}

// Mouse AI
function moveMouse() {
  let roll = Math.floor(Math.random() * 20) + 1;
  if (roll <= MouseAI) {
    if (Mouse==="CAM1") Mouse=Math.random()<0.6?"CAM1B":"CAM2";
    else if (Mouse==="CAM1B") Mouse=Math.random()<0.9?"CAM1B":"CAM1";
    else if (Mouse==="CAM2") Mouse="CAM3";
    else if (Mouse==="CAM3") Mouse="CAM8";
    else if (Mouse==="CAM8") Mouse="CAM6";
    else if (Mouse==="CAM6") Mouse="CAM9B";
    else if (Mouse==="CAM9B") Mouse="doorB";
    updateCameraView();
    checkDoorStates();
  }
}

// ====== DOOR & INFECTION LOGIC ======
document.addEventListener("keydown", e => {
  if (e.key === "a" || e.key === "A") {
    doorAClosed = !doorAClosed;
    document.getElementById("doorA").src = doorAClosed ? "doorAon.png" : "doorAoff.png";
    if (doorAClosed) resetDoor("A");
  }
  if (e.key === "d" || e.key === "D") {
    doorBClosed = !doorBClosed;
    document.getElementById("doorB").src = doorBClosed ? "doorBon.png" : "doorBoff.png";
    if (doorBClosed) resetDoor("B");
  }
});

function startInfectionMeter() {
  infectionInterval = setInterval(() => {
    if ((Punch==="doorA" && !doorAClosed) || (Snipe==="doorB" && !doorBClosed) || (Mouse==="doorB" && !doorBClosed)) {
      infected = Math.min(60, infected+1);
      darkenScreen();
    }
  }, 2000);
}

function darkenScreen() {
  let overlay = document.getElementById("darkOverlay");
  overlay.style.opacity = infected/60; // 0 to 1
}

function checkDoorStates() {
  if (Punch==="doorA" && !doorAClosed) {
    if (!punchDoorTimer) punchDoorTimer = setTimeout(()=>killPlayer("Punch"),10000);
  }
  if (Snipe==="doorB" && !doorBClosed) {
    if (!snipeDoorTimer) snipeDoorTimer = setTimeout(()=>killPlayer("Snipe"),10000);
  }
  if (Mouse==="doorB" && !doorBClosed) {
    if (!mouseDoorTimer) mouseDoorTimer = setTimeout(()=>killPlayer("Mouse"),10000);
  }
}

function resetDoor(which) {
  if (which==="A") {
    if (Punch==="doorA") {
      Punch="CAM1";
      clearTimeout(punchDoorTimer);
      punchDoorTimer = null;
    }
  }
  if (which==="B") {
    if (Snipe==="doorB") {
      Snipe="CAM1";
      clearTimeout(snipeDoorTimer);
      snipeDoorTimer = null;
    }
    if (Mouse==="doorB") {
      Mouse="CAM1";
      clearTimeout(mouseDoorTimer);
      mouseDoorTimer = null;
    }
  }
  updateCameraView();
}

function killPlayer(enemy) {
  // Show jumpscare image
  const camView = document.getElementById("camView");
  camView.style.display = "block";
  camView.src = enemy.toLowerCase() + "jumpscare.png"; // e.g. punchjumpscare.png

  // Play jumpscare audio
  let audio = new Audio("jumpscare.mp3");
  audio.play();

  // End game (simple example: reload page)
  setTimeout(()=>{ location.reload(); }, 3000);
}
    document.getElementById("newGameBtn").addEventListener("click", startNewGame);
    document.getElementById("cameraBtn").addEventListener("click", toggleCamera);


  </script>
</body>
</html>
